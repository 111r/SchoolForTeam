@{

    Layout = "~/Views/Shared/_Layout.cshtml";
}


<style>
    .table-bordered > thead > tr > th, .table-bordered > thead > tr > td {
        border-bottom-width: 2px;
        color: #E9837F;
        background-color: #ffffff;
    }
</style>





<div class="right_col" role="main">
    <div class="row">
        <!-- row started -->
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="dashboard_graph">
                <div class="row x_title">
                    <div class="col-md-4 col-sm-4 col-xs-12">
                        <h5 class="sis_heading">Previous <i class="glyphicon glyphicon-triangle-left"></i> Date : <span> 15 june 2015 </span> <i class="glyphicon glyphicon-triangle-right"></i> Next Day </h5>
                    </div>

                    <div class="col-md-4 col-sm-4 col-xs-12" style="margin:7px 0px;">
                        <!-- <h4><button type="button" class="form_datetime btn btn-info pull-right" id="datetimepicker" data-date="12-02-2012" data-date-format="dd-mm-yyyy"> Select Day </button></h4>-->
                        Select Day : <input type="text" id="DateId" value="@DateTime.Now.ToString("dd-MM-yyyy")" style="width:90px;" class=" datepicker">


                    </div>
                    <div class="col-md-4 col-sm-4 col-xs-12">
                        <button class="btn btn-info pull-right"><a href="/Master/SetTimeTable" class="button_a">Set Time Table </a></button>
                        <button class="btn btn-danger pull-right"><a href="/Master/ViewTimeTable" class="button_a">View Time Table</a></button>
                    </div>
                    <div class="col-sm-7" style="margin-top: 15px;">
                        <div class="col-sm-4">

                            <div class="form-group">
                                <label class="control-label col-sm-6">Select Class :</label>
                                <div class="col-sm-6">
                                    <select class="form-control" id="Class_Id" name="Class_Id">
                                        <option value="0">---Select Class---</option>
                                        @{
                                            foreach (var item1 in ViewBag.Classes as IEnumerable<SchoolManagement.Website.Models.Tbl_Class>)
                                            {
                                                <option value="@item1.Class_Id">@item1.Class_Name</option>
                                            }
                                        }
                                    </select>
                                </div>
                            </div>
                        </div><!--col-md-6 closed -->
                        <div class="col-sm-4">
                            <div class="form-group">
                                <label class="control-label col-sm-7">Select Section :</label>
                                <div class="col-sm-5">
                                    <select class="form-control" id="Section_Id" name="Section_Id">
                                        <option value="0">---Select Section---</option>
                                        @{
                                            foreach (var item2 in ViewBag.Section as IEnumerable<SchoolManagement.Website.Models.Tbl_SectionSetup>)
                                            {
                                                <option value="@item2.Section_Id">@item2.Section</option>
                                            }
                                        }
                                    </select>
                                </div>
                            </div>
                        </div><!--col-md-6 closed -->
                        <div class="col-sm-4">
                            <button type="button" class="btn btn-success" id="BtnManageTimePeriod">Show</button>
                        </div>
                    </div><!--col-md-7 closed -->
                </div><!-- row x_title closed-->
            </div><!-- dashboard_graph closed-->
        </div><!--col-md-12 closed -->

        <div class="col-md-12 col-sm-12 col-xs-12 table-responsive">
            <!-- col-msx-12 started -->
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th class="head_color">Day</th>
                        @{
                            foreach (var item in ViewBag.Timeperiod as IEnumerable<SchoolManagement.Website.Models.Tbl_SetTime>)
                            {
                                <th class="head_color">@item.Time</th>
                            }
                        }
                    </tr>
                </thead>
                <tbody id="TableBody">
                   
                </tbody>
            </table>
        </div><!-- col-sm-12 closed -->
    </div><!-- 1st row closed -->
</div>
<div>
    <div class="modal fade" id="2" 5 aria-hidden="true" style="  z-index: 99999;">
        <form action="/Master/UpdateTimeTable" method="post" id="Mangageform"enctype="multipart/form-data">
            <div class="form-group">
                <input type="hidden" id="TimeTable_Id" name="TimeTable_Id"/>
            </div>
            <div class="form-group">
                <input type="hidden" id="Day_ID" name="Day_ID"/>
            </div>
            <div class="form-group">
                <input type="hidden" id="Time_ID" name="Time_ID"/>
            </div>
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h2 class="modal-title" style="color:#0068ad;font-weight:bold;text-align: center;">Set a New Period</h2>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label>Class :</label>
                            <select class="form-control" id="Class_Id1" name="Class_Id">
                                <option value="0">---Select Class---</option>
                                @{
                                    foreach (var item1 in ViewBag.Classes as IEnumerable<SchoolManagement.Website.Models.Tbl_Class>)
                                    {
                                        <option value="@item1.Class_Id">@item1.Class_Name</option>
                                    }
                                }
                            </select>
                            <input type="text" id="Class_Name" name="Class_Name" style="display:none"/>
                        </div>

                        <div class="form-group">
                            <label>Section :</label>
                            <select class="form-control" id="Section_Id1" name="Section_Id">
                                <option value="0">---Select Section---</option>
                                @{
                                    foreach (var item2 in ViewBag.Section as IEnumerable<SchoolManagement.Website.Models.Tbl_SectionSetup>)
                                    {
                                        <option value="@item2.Section_Id">@item2.Section</option>
                                    }
                                }
                            </select>
                            <input type="text" id="Section_Name" name="Section_Name" style="display:none"/>
                        </div>
                        <div class="form-group">
                            <label>Subject:</label>
                            <select class="form-control" id="Subject_ID" name="Subject_ID">
                                <option value="0">---Select Subject---</option>
                                @{
                                    foreach (var item2 in ViewBag.SubjectList as IEnumerable<SchoolManagement.Website.Models.Tbl_SubjectsSetup>)
                                    {
                                        <option value="@item2.Subject_ID">@item2.Subject_Name</option>
                                    }
                                }
                            </select>
                            <input type="text" id="Subject_Name" name="Subject_Name" style="display:none"/>
                        </div>
                        <div class="form-group">
                            <label>Staff:</label>
                            <select class="form-control" id="StafId" name="StafId">
                                <option value="0">---Select Staff---</option>
                                @{
                                    foreach (var item2 in ViewBag.StaffDetails as IEnumerable<SchoolManagement.Data.Models.StafsDetails>)
                                    {
                                        <option value="@item2.StafId">@item2.Name</option>
                                    }
                                }
                            </select>
                            <input type="text" id="Staff_Name" name="Staff_Name" style="display:none"/>
                        </div>
                        <div class="form-group">
                            <label for="sel1">Select Room :</label>
                            <select class="form-control" id="Room_Id" name="Room_Id">
                                <option value="0">---Select Room---</option>
                                @{
                                    foreach (var item2 in ViewBag.RoomList as IEnumerable<SchoolManagement.Website.Models.Tbl_Room>)
                                    {
                                        <option value="@item2.Room_Id">@item2.Room_Name</option>
                                    }
                                }
                            </select>
                            <input type="text" id="Room_Name" name="Room_Name" style="display:none"/>
                        </div>
                        <div class="form-group">
                            <label>Date:</label>
                            <input type="text" id="Date" name="Date" class="form-control" readonly/>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary pull-right" id="btn-sign" style="margin-top:20px">Update</button>
                    </div>


                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </form>

    </div>
</div>


@section scripts{
    <script src="~/Scripts/WebsiteJs/js/jquery.min.js"></script>

    <script>
        $("#BtnManageTimePeriod").on('click', function () {
            var classid = $("#Class_Id").val();
            var sectionid = $("#Section_Id").val();
            var DateId = $("#DateId").val();

            if (classid == 0 || sectionid == 0 || DateId == null) {
                alert("Please Select the Fields");
            }
            else
            {
                $.ajax
                    ({
                        url: "/Master/TimeTableManage",
                        data: { classid: classid, sectionid: sectionid, DateId: DateId },
                        type: "GET",
                        dataType: "json",
                        contentType: "application/json;charset=utf-8",
                        success: function (result) {
                            
                            $("#TableBody").empty();
                            $("#TableBody").append(result);
                            //var i;
                            //alert(result[1].Week_day);
                            //$.each(result, function (index,item) {
                            //    var row = "<tr><th class='head_color'>" + item.Week_day + "</th></tr>";
                            //    //$("#TableHead").append("<tr><th class='head_color'>" + item.Time + "</th></tr>");
                            //});
                            //if (result[i] != null) {
                            //    result[i].forEach(function (data) {

                            //        var row = "<tr><th class='head_color'>" + data[i].Time + "</th></tr>";
                            //        $("#TableHead").append(row);

                            //    });
                            //}
                        }
                    });
            }
        });

        function Managetimetable(id) {
            //alert(id);
            $.ajax({
                url: "/Master/ManageTimeById?id=" + id,
                type: "GET",
                dataType: "json",
                contentType: "application/json;charset=UTF-8",
                success: function (result) {
                    if (result != "Fail") {
                        $("#TimeTable_Id").val(result.TimeTable_Id);
                        $("#Day_ID").val(result.Day_ID);
                        $("#Time_ID").val(result.Time_ID);
                        $("#Class_Id1").val(result.Class_Id);
                        $("#Class_Name").val(result.Class_Name);
                        $("#Section_Id1").val(result.Section_Id);
                        $("#Section_Name").val(result.Section_Name);
                        $("#Subject_ID").val(result.Subject_ID);
                        $("#Subject_Name").val(result.Subject_Name);
                        $("#Section_Id").val(result.Section_Id);
                        $("#Section_Name").val(result.Section_Name);
                        $("#Room_Id").val(result.Room_Id);
                        $("#Room_Name").val(result.Room_Name);
                        $("#Date").val(result.Date);

                    } else {
                        alert("No Data available in the database");
                    }
                }
            });
        }
    </script>

}